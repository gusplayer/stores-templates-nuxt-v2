"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addLayersToFunctionWalkthrough = void 0;
const addLayerToFunctionUtils_1 = require("../utils/addLayerToFunctionUtils");
const layerParams_1 = require("../utils/layerParams");
const confirmationPrompt = 'Do you want to configure Lambda layers for this function?';
exports.addLayersToFunctionWalkthrough = async (context, runtime, previousSelections = []) => {
    let lambdaLayers = [];
    let dependsOn = [];
    if (!(await context.amplify.confirmPrompt.run(confirmationPrompt, false))) {
        return { lambdaLayers, dependsOn };
    }
    let askArnQuestion;
    ({ lambdaLayers, dependsOn, askArnQuestion } = await addLayerToFunctionUtils_1.askLayerSelection(layerParams_1.getLayerMetadataFactory(context), context.amplify.getProjectMeta(), runtime.value, previousSelections));
    if (askArnQuestion) {
        lambdaLayers = lambdaLayers.concat(await addLayerToFunctionUtils_1.askCustomArnQuestion(lambdaLayers.length, previousSelections));
    }
    if (lambdaLayers.length === 0) {
        context.print.info('No Lambda layers were selected');
    }
    lambdaLayers = await addLayerToFunctionUtils_1.askLayerOrderQuestion(lambdaLayers, previousSelections);
    return { lambdaLayers, dependsOn };
};
//# sourceMappingURL=addLayerToFunctionWalkthrough.js.map