<template>
  <div class="wrapper-content" :style="Settings" v-if="productInfo">
    <div class="container">
      <div class="img-content">
        <img :src="selectPhotoUrl" class="img-product" alt="Imagen producto" />
      </div>
      <div class="info-content">
        <div class="container-info">
          <div class="category-product-content">
            <p class="category-product">
              {{
                productInfo.detalle.categoria_producto.nombre_categoria_producto
              }}
            </p>
          </div>
          <div class="name-product-content">
            <p class="name-product">{{ productInfo.detalle.nombre }}</p>
          </div>
          <div
            class="description-product-content"
            v-if="productInfo.info.descripcion"
          >
            <p
              class="description-product"
              v-if="productInfo.info.descripcion.length > 400"
              v-html="`${productInfo.info.descripcion.slice(0, 400)}...`"
            >
              {{ productInfo.info.descripcion }}
            </p>
            <p
              class="description-product"
              v-else
              v-html="`${productInfo.info.descripcion.slice(0, 400)}`"
            >
              {{ productInfo.info.descripcion }}
            </p>
          </div>
          <div class="photos-product-content">
            <div class="photos-selected">
              <image-cloudinary
                :src="setMiniPhoto(productInfo.detalle.foto_cloudinary)"
                v-on:mouseover.native="
                  selectedPhoto(productInfo.detalle.foto_cloudinary)
                "
                class="img"
              />
              <image-cloudinary
                :src="setMiniPhoto(foto.foto_cloudinary)"
                v-on:mouseover.native="selectedPhoto(foto.foto_cloudinary)"
                v-for="(foto, itemsfoto) in productInfo.fotos"
                class="img"
                :key="itemsfoto"
              />
            </div>
            <div class="button-content-product">
              <button ref="colorBtn" class="btn-product">
                Detalles del producto
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: "Ko-Content-4",
  props: {
    dataStore: Object,
    Settings: Object,
  },
  created() {
    this.$store.dispatch("GET_PRODUCT_INFO", 8876);
    if (this.productInfo) {
      this.selectPhotoUrl = this.ImageCloudinary(
        this.productInfo.detalle.foto_cloudinary,
        { width: 1200 }
      );
    }
  },
  mounted() {
    if (this.Settings) {
      this.setBackgroungHover();
    }
  },
  data() {
    return {
      selectPhotoUrl: "",
    };
  },
  computed: {
    // colorCSS() {
    //   return this.Settings["--color_background_btn"];
    // },
    productInfo() {
      return this.$store.state.productInfo;
    },
  },
  methods: {
    setBackgroungHover() {
      if (this.$refs.colorBtn) {
        let color = getComputedStyle(this.$refs.colorBtn).getPropertyValue(
          "--color_background_btn"
        );
        let colorArray = color.split(",");
        let colorInt = parseInt(colorArray[2]);
        if (colorInt > 75) {
          colorArray[2] = `${parseInt(colorArray[2]) - 10}%`;
          this.$refs.colorBtn.style.setProperty(
            "--btnhover",
            colorArray.join(",")
          );
        } else {
          colorArray[2] = `${parseInt(colorArray[2]) + 10}%`;
          this.$refs.colorBtn.style.setProperty(
            "--btnhover",
            colorArray.join(",")
          );
        }
      }
    },
    setMiniPhoto(photo) {
      if (photo === "placeholder1.svg") {
        return require(`../../assets/${photo}`);
      }
      return photo;
    },
    selectedPhoto(photo) {
      if (photo === "placeholder1.svg") {
        this.selectPhotoUrl = require(`../../assets/${photo}`);
      } else {
        this.selectPhotoUrl = this.ImageCloudinary(photo, { width: 1200 });
      }
      this.existYoutube = false;
    },
  },
  watch: {
    productInfo() {
      this.selectPhotoUrl = this.ImageCloudinary(
        this.productInfo.detalle.foto_cloudinary,
        { width: 1200 }
      );
    },
    colorCSS(value) {
      let colorArray = value.split(",");
      let colorInt = parseInt(colorArray[2]);
      if (colorInt > 75) {
        colorArray[2] = `${parseInt(colorArray[2]) - 10}%`;
        this.$refs.colorBtn.style.setProperty(
          "--btnhover",
          colorArray.join(",")
        );
      } else {
        colorArray[2] = `${parseInt(colorArray[2]) + 10}%`;
        this.$refs.colorBtn.style.setProperty(
          "--btnhover",
          colorArray.join(",")
        );
      }
    },
  },
};
</script>

<style scoped>
div.wrapper-content {
  --btnhover: #000000;
}
.wrapper-content {
  display: flex;
  width: 100%;
  background-color: var(--background_color_1);
  justify-content: center;
  align-items: center;
  box-sizing: border-box;
}
.container {
  display: grid;
  margin: 0 auto;
  width: 100%;
  max-width: 1300px;
  padding: 50px 30px 50px;
  grid-template-columns: repeat(2, 1fr);
  gap: 100px;
}
.img-content {
  width: 100%;
  height: 500px;
}
.img-product {
  width: 100%;
  vertical-align: top;
  border-radius: 10px;
  height: 100%;
  object-fit: cover;
  object-position: center;
}
.name-product {
  font-size: 42px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.24;
  letter-spacing: -0.4px;
  color: var(--color_text);
}
.photos-product-content {
  width: 100%;
}
.photos-selected {
  display: grid;
  grid-template-columns: repeat(3, 84.16px);
  gap: 15px;
}
.img {
  width: 100%;
  height: 80px;
  object-fit: cover;
  object-position: center;
  border-radius: 10px;
}
.img:hover {
  height: 80px;
}
.btn-product {
  color: var(--color_text_btn);
  border-radius: var(--radius_btn);
  border: solid 2px var(--color_border_btn);
  background-color: var(--color_background_btn);
  padding: 12px 15px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  transition: all 200ms ease-in;
}
.btn-product:hover {
  background-color: var(--btnhover);
}
.button-content-product {
  width: 100%;
  padding-top: 50px;
}
.name-product-content {
  padding: 10px 0px 30px 0px;
}
.description-product-content {
  padding-bottom: 40px;
}
.description-product {
  color: var(--color_subtext);
  text-align: justify;
}
.category-product {
  color: var(--color_subtext);
}
.info-content {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  overflow: hidden;
}
@media (max-width: 1000px) {
  .container {
    display: initial;
  }
  .info-content {
    padding-top: 30px;
  }
}
@media (max-width: 330px) {
  .photos-selected {
    grid-template-columns: repeat(3, 1fr);
  }
}
</style>
